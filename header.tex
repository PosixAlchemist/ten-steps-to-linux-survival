% Packages I added.
\usepackage{placeins}
\usepackage{caption}
\usepackage{float}
\usepackage{flafter}
\usepackage{makeidx}
\usepackage[nottoc]{tocbibind}
\usepackage{fancyhdr}
\usepackage{xcolor}
\usepackage{framed}
\usepackage{tocloft}
% End of packages I added.

% Overriding commands.
\makeindex
\restylefloat{figure}
\floatplacement{figure}{H}
% Originals from http://www-rohan.sdsu.edu/~aty/bibliog/latex/floats.html
% General parameters, for ALL pages:
\renewcommand{\topfraction}{0.7}	  % max fraction of floats at top
\renewcommand{\bottomfraction}{0.7}	% max fraction of floats at bottom
\renewcommand{\textfraction}{0.3}	  % allow minimal text w. figs
% Parameters for TEXT pages (not float pages):
\setcounter{topnumber}{2}
\setcounter{bottomnumber}{2}
\setcounter{totalnumber}{2}         % 2 may work better
% Parameters for FLOAT pages (not text pages):
% N.B.: floatpagefraction MUST be less than topfraction !!
\renewcommand{\floatpagefraction}{0.65}	% require fuller float pages
% Parameters for double-column pages:
\renewcommand{\dbltopfraction}{0.9}	% fit big float above 2-col. text
\renewcommand{\dblfloatpagefraction}{0.7}	% require fuller float pages
\setcounter{dbltopnumber}{2}        % for 2-column pages
\overfullrule=2cm   % Black bars to show overfull boxes
\numberwithin{figure}{chapter}
\DeclareRobustCommand{\drbsd}[1]{\index{operating systems!#1}\index{operating systems!BSD}\index{BSD (operating system)}\index{#1 (operating system)}}
\DeclareRobustCommand{\drcap}[1]{\begin{figure}[H]\caption{#1}\end{figure}}
\DeclareRobustCommand{\drcmd}[1]{\index{commands!#1@\texttt{#1}}}
\DeclareRobustCommand{\drdis}[1]{\index{Linux distros!#1}\index{#1 (Linux distro)}}
\DeclareRobustCommand{\drdoc}[1]{\index{documentation!#1@\texttt{#1} command}\index{#1@\texttt{#1} (documentation command)}\index{commands!#1@\texttt{#1} (documentation)}}
\DeclareRobustCommand{\dreds}[1]{\index{editors!#1@\texttt{#1}}\index{#1@\texttt{#1} (editor)}\index{commands!#1@\texttt{#1} (editor)}}
\DeclareRobustCommand{\drenv}[2]{\index{environment variables!#1@\texttt{\$}\texttt{#1} (#2)}}
\DeclareRobustCommand{\drios}[1]{\index{operating systems!#1}\index{#1 (operating system)}}
\DeclareRobustCommand{\drnet}[1]{\index{network commands!#1@\texttt{#1}}\index{#1@\texttt{#1} (network command)}\index{commands!#1@\texttt{#1} (network)}}
\DeclareRobustCommand{\drpkg}[1]{\index{package management!#1@\texttt{#1}}\index{#1@\texttt{#1} (package management)}\index{commands!#1@\texttt{#1} (package management)}}
\DeclareRobustCommand{\drshl}[1]{\index{shells!#1}\index{#1 (shell)}}
\DeclareRobustCommand{\drstd}[1]{\index{I/O!streams!#1@\textit{#1}}\index{#1@\textit{#1} (stream)}\index{streams!#1@\textit{#1}}}
\DeclareRobustCommand{\drunx}[1]{\index{UNIX-like environments!#1}\index{#1 (UNIX-like environment)}}
\DeclareRobustCommand{\drvic}[2]{\index{vicommands@\texttt{vi} commands!#1@\texttt{#1} (#2)}}
\renewcommand{\KeywordTok}[1]{{#1}}
\renewcommand{\DataTypeTok}[1]{{#1}}
\renewcommand{\DecValTok}[1]{{#1}}
\renewcommand{\BaseNTok}[1]{{#1}}
\renewcommand{\FloatTok}[1]{{#1}}
\renewcommand{\CharTok}[1]{{#1}}
\renewcommand{\StringTok}[1]{{#1}}
\renewcommand{\CommentTok}[1]{{#1}}
\renewcommand{\OtherTok}[1]{{#1}}
\renewcommand{\AlertTok}[1]{{#1}}
\renewcommand{\FunctionTok}[1]{{#1}}
\renewcommand{\RegionMarkerTok}[1]{{#1}}
\renewcommand{\ErrorTok}[1]{{#1}}
\renewcommand{\NormalTok}[1]{{#1}}
\renewcommand{\ConstantTok}[1]{{#1}}
\renewcommand{\SpecialCharTok}[1]{{#1}}
\renewcommand{\VerbatimStringTok}[1]{{#1}}
\renewcommand{\SpecialStringTok}[1]{{#1}}
\renewcommand{\ImportTok}[1]{{#1}}
\renewcommand{\DocumentationTok}[1]{{#1}}
\renewcommand{\AnnotationTok}[1]{{#1}}
\renewcommand{\CommentVarTok}[1]{{#1}}
\renewcommand{\VariableTok}[1]{{#1}}
\renewcommand{\ControlFlowTok}[1]{{#1}}
\renewcommand{\OperatorTok}[1]{{#1}}
\renewcommand{\BuiltInTok}[1]{{#1}}
\renewcommand{\ExtensionTok}[1]{{#1}}
\renewcommand{\PreprocessorTok}[1]{{#1}}
\renewcommand{\AttributeTok}[1]{{#1}}
\renewcommand{\RegionMarkerTok}[1]{{#1}}
\renewcommand{\InformationTok}[1]{{#1}}
\renewcommand{\WarningTok}[1]{{#1}}
% End of overriding commands.
